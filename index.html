<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Tile Price Manager - PDF Generator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-text-size-adjust: 100%;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
            padding: 15px;
            padding-top: 20px;
            -webkit-user-select: none;
            user-select: none;
        }

        .container {
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            width: 100%;
            max-width: 1200px;
            overflow: hidden;
            margin-bottom: 20px;
        }

        .tabs {
            display: flex;
            border-bottom: 2px solid #f0f0f0;
            background: #f9f9f9;
        }

        .tab-button {
            flex: 1;
            padding: 14px 16px;
            border: none;
            background: transparent;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            color: #666;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            text-align: center;
            -webkit-user-select: none;
            user-select: none;
        }

        .tab-button.active {
            color: #d32f2f;
            border-bottom-color: #d32f2f;
        }

        .content {
            padding: 20px;
            max-height: 85vh;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 600;
            color: #333;
            font-size: 13px;
        }

        .input-wrapper {
            position: relative;
        }

        .form-group input {
            width: 100%;
            padding: 12px 14px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            font-family: inherit;
            -webkit-appearance: none;
            appearance: none;
        }

        .form-group input:focus {
            outline: none;
            border-color: #d32f2f;
            box-shadow: 0 0 0 3px rgba(211, 47, 47, 0.1);
        }

        .price-wrapper {
            position: relative;
            display: flex;
            align-items: center;
        }

        .price-symbol {
            position: absolute;
            left: 14px;
            font-weight: 700;
            color: #333;
            font-size: 16px;
            pointer-events: none;
            z-index: 2;
            top: 50%;
            transform: translateY(-50%);
        }

        .price-input {
            width: 100%;
            padding: 12px 14px 12px 36px !important;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            font-family: inherit;
            -webkit-appearance: none;
            appearance: none;
            background: white;
            -moz-appearance: textfield;
        }

        .price-input::-webkit-outer-spin-button,
        .price-input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        .suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #ddd;
            border-top: none;
            border-radius: 0 0 8px 8px;
            max-height: 250px;
            overflow-y: auto;
            z-index: 100;
            display: none;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            -webkit-overflow-scrolling: touch;
        }

        .suggestions.show {
            display: block;
        }

        .suggestion-item {
            padding: 11px 14px;
            cursor: pointer;
            transition: background 0.2s ease;
            font-size: 13px;
            color: #333;
            user-select: none;
            -webkit-user-select: none;
        }

        .suggestion-item.highlighted {
            background: #f5f5f5;
            color: #d32f2f;
            font-weight: 600;
        }

        .buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-top: 24px;
        }

        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            -webkit-user-select: none;
            user-select: none;
        }

        .btn-add {
            background: #4caf50;
            color: white;
        }

        .btn-add:active {
            background: #45a049;
        }

        .btn-pdf {
            background: #d32f2f;
            color: white;
        }

        .btn-pdf:active {
            background: #b71c1c;
        }

        .items-section {
            margin-top: 24px;
        }

        .items-title {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin-bottom: 12px;
        }

        .items-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            font-size: 13px;
        }

        .items-table thead {
            background: #d32f2f;
            color: white;
        }

        .items-table th {
            padding: 10px 8px;
            text-align: left;
            font-weight: 600;
            font-size: 12px;
        }

        .items-table td {
            padding: 10px 8px;
            border-bottom: 1px solid #f0f0f0;
            font-size: 12px;
        }

        .btn-delete {
            background: #ef5350;
            color: white;
            border: none;
            padding: 6px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 11px;
            font-weight: 600;
            -webkit-user-select: none;
            user-select: none;
        }

        .empty-state {
            text-align: center;
            padding: 30px 20px;
            color: #999;
            background: #f9f9f9;
            border-radius: 8px;
            font-size: 13px;
        }

        .success-message {
            background: #4caf50;
            color: white;
            padding: 12px;
            border-radius: 6px;
            margin-bottom: 16px;
            font-size: 13px;
            display: none;
        }

        .success-message.show {
            display: block;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
            color: #d32f2f;
        }

        .loading.show {
            display: block;
        }

        @media (max-width: 768px) {
            .buttons {
                grid-template-columns: 1fr;
            }

            .content {
                padding: 16px;
            }
        }

        #pdfContainer {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="tabs">
            <button class="tab-button active" data-tab="basic">Basic</button>
            <button class="tab-button" data-tab="advance">Advance</button>
        </div>

        <div class="content">
            <!-- BASIC TAB -->
            <div class="tab-content active" id="basic">
                <div class="success-message" id="successMsg">✓ Entry added successfully</div>

                <div class="form-group">
                    <label for="size">Size</label>
                    <div class="input-wrapper">
                        <input type="text" id="size" placeholder="Select or type size" autocomplete="off">
                        <div class="suggestions" id="sizeSuggestions"></div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="surface">Surface</label>
                    <div class="input-wrapper">
                        <input type="text" id="surface" placeholder="Select or type surface" autocomplete="off">
                        <div class="suggestions" id="surfaceSuggestions"></div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="price">Price</label>
                    <div class="price-wrapper">
                        <span class="price-symbol">₹</span>
                        <input type="number" id="price" class="price-input" placeholder="Enter price" min="0" step="0.01" inputmode="decimal">
                    </div>
                </div>

                <div class="buttons">
                    <button class="btn btn-add" id="addBtn">Add</button>
                    <button class="btn btn-pdf" id="pdfBtn">Generate PDF</button>
                </div>

                <div class="loading" id="loading">Generating PDF...</div>

                <div class="items-section">
                    <div class="items-title">Added Items</div>
                    <div id="itemsContainer"></div>
                </div>
            </div>

            <!-- ADVANCE TAB -->
            <div class="tab-content" id="advance">
                <div style="text-align: center; padding: 60px 20px; color: #999; font-size: 16px;">
                    Advance features coming soon...
                </div>
            </div>
        </div>
    </div>

    <div id="pdfContainer"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script>
        const sizes = ['1200x1200x9MM', '1200x1790x9MM', '1200x1800x9MM', '1200x2400x9MM', '1200x2800x9MM', '1200x3180x15MM', '1200x3200x15MM', '1600x1600x9MM', '1600x3200x12MM', '1620x3240x12MM', '798x2980x15MM', '800x3000x15MM', '1080x3000x5MM', '1200x3000x9MM', '1200x3200x9MM', '800x3200x15MM'];
        const surfaces = ['ELEGANCE', 'REPOSE', 'CARVE TECH', 'LUMINOUS', 'GRACE', 'GRAVEL', 'SAHARA', 'SHAPE TECH', 'CRYSTAL', 'GAMMA', 'GALAXY'];

        const companyInfo = {
            name: 'COMET GRANITO PVT. LTD',
            cin: 'C.I. No.: U26914GJ2006PTC049091',
            email: 'info@granicer.in',
            web: 'www.granicer.in',
            registeredOffice: {
                title: 'Registered Office:',
                address: ['Survey no. 118, National Highway No. 8-A,', 'Tal. Morbi, Nava Jambudia,', 'GJ 363642, INDIA.']
            },
            unit2: {
                title: 'Unit - 2:',
                address: ['Revenue Survey No. 168 P1 and P2', 'Revenue Survey No. 169 P1 and P6', 'At Ratavirda, Wankaner, Morbi-Guj. -363621']
            }
        };

        const terms = [
            'All prices are ex-factory and exclusive of GST unless stated otherwise.',
            'Prices are subject to change without prior notice depending on market conditions.',
            'Delivery period will be confirmed after order placement.',
            'The company is not responsible for delays due to transport or unforeseen events.',
            'The company is not liable once goods leave the factory.',
            'GST and any other government levies will be charged extra as applicable at the time of billing.',
            'No return or replacement will be accepted once goods are sold, except for genuine manufacturing defects verified by the company.',
            'Placing an order implies acceptance of the above terms & conditions.'
        ];

        let items = [];
        let currentSuggestionIndex = -1;

        const GITHUB_BASE = 'https://raw.githubusercontent.com/mayurmatholiya01-creator/price/main/';
        const GRANICER_LOGO = GITHUB_BASE + 'GRANICER%20LOGO.png';
        const A_LOGO = GITHUB_BASE + 'A%20LOGO.png';

        // TAB SWITCHING
        document.querySelectorAll('.tab-button').forEach(button => {
            button.addEventListener('click', () => {
                const tabName = button.getAttribute('data-tab');
                document.querySelectorAll('.tab-button').forEach(b => b.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                button.classList.add('active');
                document.getElementById(tabName).classList.add('active');
            });
        });

        // AUTOCOMPLETE
        function setupAutocomplete(inputId, suggestionsId, dataArray, validationType) {
            const input = document.getElementById(inputId);
            const suggestionsDiv = document.getElementById(suggestionsId);

            input.addEventListener('input', (e) => {
                let value = e.target.value;
                
                if (validationType === 'numeric') {
                    value = value.replace(/[^0-9x]/gi, '');
                    input.value = value;
                } else if (validationType === 'alpha') {
                    value = value.replace(/[^a-zA-Z\s]/g, '').toUpperCase();
                    input.value = value;
                }

                const searchValue = value.toUpperCase().trim();
                if (searchValue.length === 0) {
                    suggestionsDiv.classList.remove('show');
                    return;
                }

                const filtered = dataArray.filter(item => item.toUpperCase().includes(searchValue));
                if (filtered.length === 0) {
                    suggestionsDiv.classList.remove('show');
                    return;
                }

                suggestionsDiv.innerHTML = filtered.map((item, idx) => 
                    `<div class="suggestion-item" data-value="${item}" data-index="${idx}">${item}</div>`
                ).join('');
                suggestionsDiv.classList.add('show');
                currentSuggestionIndex = -1;

                document.querySelectorAll(`#${suggestionsId} .suggestion-item`).forEach(item => {
                    item.addEventListener('click', () => {
                        input.value = item.getAttribute('data-value');
                        suggestionsDiv.classList.remove('show');
                    });
                });
            });

            input.addEventListener('keydown', (e) => {
                const items = document.querySelectorAll(`#${suggestionsId} .suggestion-item`);
                if (e.key === 'ArrowDown') {
                    e.preventDefault();
                    currentSuggestionIndex = Math.min(currentSuggestionIndex + 1, items.length - 1);
                    updateHighlight(suggestionsId, items);
                } else if (e.key === 'ArrowUp') {
                    e.preventDefault();
                    currentSuggestionIndex = Math.max(currentSuggestionIndex - 1, -1);
                    updateHighlight(suggestionsId, items);
                } else if (e.key === 'Enter') {
                    e.preventDefault();
                    if (currentSuggestionIndex >= 0 && items[currentSuggestionIndex]) {
                        input.value = items[currentSuggestionIndex].getAttribute('data-value');
                        suggestionsDiv.classList.remove('show');
                    }
                }
            });

            document.addEventListener('click', (e) => {
                if (!input.contains(e.target) && !suggestionsDiv.contains(e.target)) {
                    suggestionsDiv.classList.remove('show');
                }
            });
        }

        function updateHighlight(suggestionsId, items) {
            items.forEach((item, idx) => {
                item.classList.remove('highlighted');
                if (idx === currentSuggestionIndex) {
                    item.classList.add('highlighted');
                    item.scrollIntoView({ block: 'nearest' });
                }
            });
        }

        setupAutocomplete('size', 'sizeSuggestions', sizes, 'numeric');
        setupAutocomplete('surface', 'surfaceSuggestions', surfaces, 'alpha');

        // ADD ITEM
        document.getElementById('addBtn').addEventListener('click', () => {
            const size = document.getElementById('size').value.trim();
            const surface = document.getElementById('surface').value.trim().toUpperCase();
            const price = document.getElementById('price').value.trim();

            if (!size || !surface || !price || parseFloat(price) <= 0) {
                alert('Please fill all fields correctly');
                return;
            }

            items.push({
                id: Date.now(),
                size,
                surface,
                price: parseFloat(price)
            });

            renderItems();
            document.getElementById('size').value = '';
            document.getElementById('surface').value = '';
            document.getElementById('price').value = '';
            document.getElementById('size').focus();
        });

        function renderItems() {
            const container = document.getElementById('itemsContainer');
            if (items.length === 0) {
                container.innerHTML = '<div class="empty-state">No items added yet</div>';
                return;
            }

            const tableHTML = `
                <table class="items-table">
                    <thead>
                        <tr>
                            <th>Size</th>
                            <th>Surface</th>
                            <th>Price</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${items.map(item => `
                            <tr>
                                <td>${item.size}</td>
                                <td>${item.surface}</td>
                                <td>₹ ${item.price.toFixed(2)}</td>
                                <td><button class="btn-delete" onclick="deleteItem(${item.id})">Delete</button></td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
            container.innerHTML = tableHTML;
        }

        window.deleteItem = (id) => {
            items = items.filter(item => item.id !== id);
            renderItems();
        };

        // PDF GENERATION
        document.getElementById('pdfBtn').addEventListener('click', generatePDF);

        function generatePDF() {
            if (items.length === 0) {
                alert('Please add at least one item');
                return;
            }

            const loading = document.getElementById('loading');
            loading.classList.add('show');
            document.getElementById('pdfBtn').disabled = true;

            const itemsPerPage = 10;
            const totalPages = Math.ceil(items.length / itemsPerPage);
            let pdfHTML = '';

            for (let page = 0; page < totalPages; page++) {
                const startIdx = page * itemsPerPage;
                const endIdx = Math.min(startIdx + itemsPerPage, items.length);
                const pageItems = items.slice(startIdx, endIdx);
                const blankRows = itemsPerPage - pageItems.length;

                pdfHTML += `
                    <div style="width: 210mm; height: 297mm; position: relative; page-break-after: always; font-family: Arial, sans-serif; background: white; border: 3px solid #000; margin: 0; padding: 0; box-sizing: border-box; overflow: hidden; display: flex; flex-direction: column;">
                        
                        <!-- LEFT BOTTOM LOGO - ORIGINAL -->
                        <img src="${A_LOGO}" style="position: absolute; bottom: 0mm; left: 0mm; width: 15mm; height: 20MM; object-fit: contain; z-index: 1; max-width: none;">
                        
                        <!-- RIGHT TOP LOGO - ROTATED 180 + FLIPPED -->
                        <img src="${A_LOGO}" style="position: absolute; top: 0mm; right: 0mm; width: 15mm; height: 20MM; object-fit: contain; opacity: 1; z-index: 1; transform: rotate(180deg) scaleY(-1); max-width: none;">

                        <!-- MAIN CONTENT WRAPPER -->
                        <div style="position: relative; z-index: 2; padding: 15mm; flex: 1; display: flex; flex-direction: column; width: 100%; box-sizing: border-box; overflow: hidden;">
                            
                            <!-- HEADER WITH LOGO -->
                            <div style="text-align: center; margin-bottom: 6px; border-bottom: 3px solid #d32f2f; padding-bottom: 6px; flex-shrink: 0; width: 100%;">
                                <img src="${GRANICER_LOGO}" style="max-width: 100%; max-height: 42px; object-fit: contain; height: 42px;">
                            </div>

                            <!-- COMPANY INFO -->
                            <div style="width: 100%; margin-bottom: 6px; font-size: 9pt; line-height: 1.35; flex-shrink: 0; display: flex; gap: 10px;">
                                <div style="width: 50%; padding-right: 5px;">
                                    <strong>Company Details:</strong><br>
                                    ${companyInfo.name}<br>
                                    ${companyInfo.cin}<br><br>
                                    <strong>Contact:</strong><br>
                                    Email: ${companyInfo.email}<br>
                                    Web: ${companyInfo.web}
                                </div>
                                <div style="width: 50%; padding-left: 5px;">
                                    <strong>${companyInfo.registeredOffice.title}</strong><br>
                                    ${companyInfo.registeredOffice.address.join('<br>')}<br><br>
                                    <strong>${companyInfo.unit2.title}</strong><br>
                                    ${companyInfo.unit2.address.join('<br>')}
                                </div>
                            </div>

                            <!-- PRICE LIST TITLE -->
                            <h2 style="text-align: center; color: #d32f2f; font-size: 12pt; margin: 4px 0; text-transform: uppercase; letter-spacing: 1px; flex-shrink: 0;">Price List</h2>

                            <!-- TABLE -->
                            <table style="width: 100%; border-collapse: collapse; margin-bottom: 6px; flex-grow: 1; font-size: 8pt; table-layout: fixed;">
                                <thead>
                                    <tr style="background: #d32f2f; color: white; height: 22px;">
                                        <th style="border: 1px solid #999; padding: 4px 2px; text-align: center; width: 10%; font-weight: bold;">Sr. No.</th>
                                        <th style="border: 1px solid #999; padding: 4px 2px; text-align: left; width: 30%; font-weight: bold;">Size</th>
                                        <th style="border: 1px solid #999; padding: 4px 2px; text-align: left; width: 30%; font-weight: bold;">Surface Type</th>
                                        <th style="border: 1px solid #999; padding: 4px 2px; text-align: right; width: 30%; font-weight: bold;">Price (Per Unit)</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${pageItems.map((item, idx) => `
                                        <tr style="background: ${(startIdx + idx) % 2 === 0 ? '#fafafa' : 'white'}; height: 18px;">
                                            <td style="border: 1px solid #ddd; padding: 3px 2px; text-align: center;">${startIdx + idx + 1}</td>
                                            <td style="border: 1px solid #ddd; padding: 3px 2px; text-align: left; word-break: break-word;">${item.size}</td>
                                            <td style="border: 1px solid #ddd; padding: 3px 2px; text-align: left; word-break: break-word;">${item.surface}</td>
                                            <td style="border: 1px solid #ddd; padding: 3px 2px; text-align: right;">₹ ${item.price.toFixed(2)}</td>
                                        </tr>
                                    `).join('')}
                                    ${Array(blankRows).fill(0).map(() => `
                                        <tr style="background: white; height: 18px;">
                                            <td style="border: 1px solid #ddd; padding: 3px 2px;"></td>
                                            <td style="border: 1px solid #ddd; padding: 3px 2px;"></td>
                                            <td style="border: 1px solid #ddd; padding: 3px 2px;"></td>
                                            <td style="border: 1px solid #ddd; padding: 3px 2px;"></td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>

                            <!-- FOOTER -->
                            <div style="border-top: 2px solid #d32f2f; padding-top: 4px; font-size: 6.5pt; line-height: 1.25; flex-shrink: 0; width: 100%; box-sizing: border-box; overflow: hidden;">
                                <strong style="color: #d32f2f;">Terms & Conditions:</strong>
                                <ul style="margin-left: 10px; margin-top: 2px; padding-left: 0; margin-bottom: 2px;">
                                    ${terms.map(term => `<li style="margin: 1px 0; text-align: justify;">${term}</li>`).join('')}
                                </ul>
                                <div style="text-align: center; margin-top: 2px; color: #666; border-top: 1px solid #ddd; padding-top: 2px;">
                                    <p style="margin: 0.5px 0;">This is an electronically generated price list. For further information, please contact our sales team.</p>
                                    <p style="margin: 0.5px 0;">Generated on: ${new Date().toLocaleDateString()}</p>
                                    <p style="margin: 0.5px 0;"><strong>GRANICER CERAMICA INDIA - Asia's Largest Porcelain Slabs & Tiles Manufacturer</strong></p>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }

            const element = document.createElement('div');
            element.innerHTML = pdfHTML;

            const opt = {
                margin: 0,
                filename: `Granicer_PriceList_${new Date().toLocaleDateString().replace(/\//g, '-')}.pdf`,
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2, useCORS: true, allowTaint: true, logging: false },
                jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait', compress: true }
            };

            html2pdf().set(opt).from(element).save().then(() => {
                loading.classList.remove('show');
                document.getElementById('pdfBtn').disabled = false;
            }).catch((error) => {
                console.error('PDF Error:', error);
                loading.classList.remove('show');
                document.getElementById('pdfBtn').disabled = false;
            });
        }

        renderItems();
    </script>
</body>
</html>
