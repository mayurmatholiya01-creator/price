<script>
        // ðŸŒŸ (V9 FIX): à¤®à¥ˆà¤‚à¤¨à¥‡ à¤¯à¤¹à¤¾à¤ à¤¸à¥‡ à¤¬à¤— à¤µà¤¾à¤²à¥€ (window.jsPDF = ...) à¤²à¤¾à¤‡à¤¨ à¤¹à¤Ÿà¤¾ à¤¦à¥€ à¤¹à¥ˆà¥¤
        // à¤…à¤¬ addItem à¤”à¤° à¤¬à¤¾à¤•à¥€ à¤¸à¤¬ à¤«à¤¼à¤‚à¤•à¥à¤¶à¤¨ à¤•à¤¾à¤® à¤•à¤°à¥‡à¤‚à¤—à¥‡à¥¤

        // --- (à¤†à¤ªà¤•à¥‡ à¤ªà¥à¤°à¤¾à¤¨à¥‡ à¤«à¤¼à¤‚à¤•à¥à¤¶à¤¨ à¤µà¥ˆà¤¸à¥‡ à¤¹à¥€ à¤°à¤¹à¥‡à¤‚à¤—à¥‡) ---
        const sizes = [
            '1200x1200x9MM',
            '1200x1790x9MM',
            '1200x1800x9MM',
            '1200x2400x9MM',
            '1200x2800x6MM',
            '1200x3180x15MM',
            '1200x3200x15MM',
            '1600x1600x9MM',
            '1600x3200x6MM',
            '1600x3200x12MM',
            '1620x3240x12MM',
            '790x2980x15MM',
            '800x3000x15MM',
            '800x2400x15MM',
            '1000x3000x5MM',
            '1200x2600x6MM',
            '1200x3000x9MM',
            '800x3200x15MM',
        ];

        const surfaces = [
            'ELEGANCE',
            'REPOSE',
            'ALL SURFACES',
            'OTHER',
            'CARVE TECH',
            'LUMINOUS',
            'GRACE',
            'GRAVEL',
            'SAHARA',
            'SHAPE TECH',
            'CRYSTAL',
            'GAMMA',
            'GALAXY',
        ];

        let items = [];
        let itemIdCounter = 0;
        let activeSuggestionIndex = -1; 

        function filterSuggestions(type) {
            activeSuggestionIndex = -1; 
            
            const inputId = type === 'size' ? 'size' : 'surface';
            const suggestionsId = type === 'size' ? 'sizeSuggestions' : 'surfaceSuggestions';
            const data = type === 'size' ? sizes : surfaces;

            const input = document.getElementById(inputId).value.toUpperCase();
            const suggestionsDiv = document.getElementById(suggestionsId);

            if (!input) {
                suggestionsDiv.classList.remove('show');
                return;
            }

            const filtered = data.filter((item) => item.toUpperCase().includes(input));

            if (filtered.length === 0) {
                suggestionsDiv.classList.remove('show');
                return;
            }

            suggestionsDiv.innerHTML = filtered
                .map(
                    (item) =>
                        `<div class="suggestion-item" onclick="selectSuggestion('${inputId}', '${item}')">${item}</div>`
                )
                .join('');

            suggestionsDiv.classList.add('show');
        }

        function selectSuggestion(inputId, value) {
            activeSuggestionIndex = -1; 
            document.getElementById(inputId).value = value;
            document
                .getElementById(inputId === 'size' ? 'sizeSuggestions' : 'surfaceSuggestions')
                .classList.remove('show');
        }

        function addItem() {
            const size = document.getElementById('size').value.trim();
            const surface = document.getElementById('surface').value.trim();
            const price = document.getElementById('price').value.trim();

            if (!size || !surface || !price) {
                alert('Please fill all fields');
                return;
            }

            const item = {
                id: itemIdCounter++,
                size: size,
                surface: surface,
                price: parseFloat(price),
            };

            items.push(item);
            renderItems();
            clearForm();
        }

        function deleteItem(id) {
            items = items.filter((item) => item.id !== id);
            renderItems();
        }

        function renderItems() {
            const container = document.getElementById('itemsContainer');
            const pdfBtn = document.getElementById('pdfBtn');

            if (items.length === 0) {
                container.innerHTML = '<div class="empty-state">No items added yet</div>';
                pdfBtn.disabled = true;
                return;
            }

            pdfBtn.disabled = false;

            let tableHTML = `
                <table>
                    <thead>
                        <tr>
                            <th>Size</th>
                            <th>Surface</th>
                            <th>Price</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
            `;

            items.forEach((item) => {
                tableHTML += `
                    <tr>
                        <td>${item.size}</td>
                        <td>${item.surface}</td>
                        <td>â‚¹ ${item.price.toFixed(2)}</td>
                        <td><button class-="delete-btn" onclick="deleteItem(${item.id})">Delete</button></td>
                    </tr>
                `;
            });

            tableHTML += '</tbody></table>';
            container.innerHTML = tableHTML;
        }

        // ðŸŒŸðŸŒŸðŸŒŸ [MODIFIED FUNCTION V9 - BUG FIX] ðŸŒŸðŸŒŸðŸŒŸ
        function generatePDF() {
            if (items.length === 0) {
                alert('Please add items first');
                return;
            }
            
            // ðŸŒŸ (V9 FIX) à¤¹à¤® jsPDF à¤‘à¤¬à¥à¤œà¥‡à¤•à¥à¤Ÿ à¤•à¥‹ à¤¸à¥€à¤§à¥‡ window.jspdf à¤¸à¥‡ à¤²à¥‡à¤‚à¤—à¥‡
            const { jsPDF } = window.jspdf;

            if (!jsPDF) {
                alert('Error: PDF library (jspdf) not found!');
                return;
            }

            // --- ðŸ à¤¸à¥à¤Ÿà¥‡à¤ª 1: à¤…à¤ªà¤¨à¥‡ Base64 à¤²à¥‹à¤—à¥‹ à¤¯à¤¹à¤¾à¤ à¤ªà¥‡à¤¸à¥à¤Ÿ à¤•à¤°à¥‡à¤‚ ---
            // (à¤¯à¥‡ à¤¸à¤¿à¤°à¥à¤« à¤ªà¥à¤²à¥‡à¤¸à¤¹à¥‹à¤²à¥à¤¡à¤° à¤¹à¥ˆà¤‚, à¤‡à¤¨à¥à¤¹à¥‡à¤‚ à¤…à¤ªà¤¨à¥‡ à¤Ÿà¥‡à¤•à¥à¤¸à¥à¤Ÿ à¤¸à¥‡ à¤¬à¤¦à¤²à¥‡à¤‚)
            const base64LogoA = 'PASTE_YOUR_BASE64_FOR_A_LOGO.png_HERE';
            const base64LogoGranicer = 'PASTE_YOUR_BASE64_FOR_GRANICER_LOGO.png_HERE';

            // à¤šà¥‡à¤¤à¤¾à¤µà¤¨à¥€ à¤…à¤—à¤° à¤²à¥‹à¤—à¥‹ à¤…à¤ªà¤¡à¥‡à¤Ÿ à¤¨à¤¹à¥€à¤‚ à¤•à¤¿à¤ à¤—à¤ à¤¹à¥ˆà¤‚
            if (base64LogoA.includes('PASTE_') || base64LogoGranicer.includes('PASTE_')) {
                alert('à¤•à¥ƒà¤ªà¤¯à¤¾ generatePDF() à¤«à¤¼à¤‚à¤•à¥à¤¶à¤¨ à¤®à¥‡à¤‚ Base64 à¤²à¥‹à¤—à¥‹ à¤¸à¥à¤Ÿà¥à¤°à¤¿à¤‚à¤—à¥à¤¸ à¤•à¥‹ à¤…à¤ªà¤¡à¥‡à¤Ÿ à¤•à¤°à¥‡à¤‚!');
                return;
            }
            
            // A4 à¤ªà¥‡à¤œ (210mm à¤šà¥Œà¤¡à¤¼à¤¾ x 297mm à¤²à¤‚à¤¬à¤¾)
            const doc = new jsPDF('p', 'mm', 'a4'); // à¤¯à¤¹ à¤…à¤¬ à¤¸à¤¹à¥€ à¤¸à¥‡ à¤•à¤¾à¤® à¤•à¤°à¥‡à¤—à¤¾
            const currentDate = new Date().toLocaleDateString('en-GB');

            // --- à¤Ÿà¥‡à¤¬à¤² à¤•à¥‡ à¤²à¤¿à¤ à¤¡à¥‡à¤Ÿà¤¾ à¤¤à¥ˆà¤¯à¤¾à¤° à¤•à¤°à¥‡à¤‚ ---
            const head = [['Sr. No.', 'Size', 'Surface Type', 'Price (/sq feet)']];
            const body = items.map((item, index) => [
                index + 1,
                item.size,
                item.surface,
                `â‚¹ ${item.price.toFixed(2)}`
            ]);

            // --- AutoTable à¤•à¤¾ à¤‡à¤¸à¥à¤¤à¥‡à¤®à¤¾à¤² ---
            doc.autoTable({
                head: head,
                body: body,
                startY: 98, // à¤Ÿà¥‡à¤¬à¤² à¤ªà¥‡à¤œ 1 à¤ªà¤° à¤•à¤¹à¤¾à¤ à¤¸à¥‡ à¤¶à¥à¤°à¥‚ à¤¹à¥‹ (à¤¹à¥‡à¤¡à¤° à¤•à¥‡ à¤¨à¥€à¤šà¥‡)
                margin: { left: 20, right: 20, top: 30, bottom: 30 }, // à¤ªà¥‡à¤œ à¤®à¤¾à¤°à¥à¤œà¤¿à¤¨
                
                // --- à¤¸à¥à¤Ÿà¤¾à¤‡à¤²à¤¿à¤‚à¤— ---
                styles: {
                    font: 'helvetica', // à¤¸à¥à¤°à¤•à¥à¤·à¤¿à¤¤ à¤«à¥‰à¤¨à¥à¤Ÿ
                    fontSize: 9,
                    cellPadding: 1.8,
                    overflow: 'linebreak'
                },
                headStyles: {
                    fillColor: [237, 50, 55], // [R, G, B] (Granicer Red)
                    textColor: [255, 255, 255], // White
                    fontSize: 10,
                    fontStyle: 'bold',
                    halign: 'center'
                },
                alternateRowStyles: {
                    fillColor: [248, 249, 250] // Light Grey
                },
                columnStyles: {
                    0: { halign: 'center', cellWidth: 15 }, // Sr. No.
                    1: { cellWidth: 'auto' }, // Size
                    2: { cellWidth: 'auto' }, // Surface
                    3: { halign: 'right', cellWidth: 30 } // Price
                },

                // --- ðŸŒŸ à¤¹à¥à¤• (Hook): à¤¹à¤° à¤ªà¥‡à¤œ à¤•à¥‹ à¤¡à¥à¤°à¥‰ à¤•à¤°à¤¨à¥‡ à¤•à¥‡ à¤¬à¤¾à¤¦ ---
                didDrawPage: function (data) {
                    
                    // --- 1. à¤•à¥‹à¤¨à¥‡ à¤µà¤¾à¤²à¥‡ à¤²à¥‹à¤—à¥‹ (à¤¹à¤° à¤ªà¥‡à¤œ à¤ªà¤°) ---
                    try {
                        // à¤Ÿà¥‰à¤ª-à¤°à¤¾à¤‡à¤Ÿ (à¤°à¥‹à¤Ÿà¥‡à¤Ÿ à¤•à¤¿à¤¯à¤¾ à¤¹à¥à¤†)
                        doc.addImage(base64LogoA, 'PNG', 192, 0, 18, 21.5, '', 'NONE', 180);
                        // à¤¬à¥‰à¤Ÿà¤®-à¤²à¥‡à¤«à¥à¤Ÿ
                        doc.addImage(base64LogoA, 'PNG', 0, 275.2, 18, 21.5);
                    } catch (e) {
                        console.error("Corner logo error:", e.message);
                    }

                    // --- 2. à¤ªà¥‡à¤œ-à¤¸à¥à¤ªà¥‡à¤¸à¤¿à¤«à¤¿à¤• à¤¹à¥‡à¤¡à¤° ---
                    if (data.pageNumber === 1) {
                        // --- à¤ªà¥‡à¤œ 1: à¤¬à¤¡à¤¼à¤¾ à¤¹à¥‡à¤¡à¤° ---
                        try {
                            // GRANICER Logo
                            doc.addImage(base64LogoGranicer, 'PNG', 70, 15, 70, 23.5);
                        } catch (e) {
                            console.error("Granicer logo error:", e.message);
                        }
                        
                        // à¤•à¤‚à¤ªà¤¨à¥€ à¤•à¥€ à¤œà¤¾à¤¨à¤•à¤¾à¤°à¥€
                        doc.setFontSize(9);
                        doc.setFont('helvetica', 'bold');
                        doc.text('Company Details:', 20, 48);
                        doc.text('Registered Office:', 105, 48);
                        doc.setFont('helvetica', 'normal');
                        doc.text('COMET GRANITO PVT.LTD.', 20, 53);
                        doc.text('C.I. No.: U26914GJ2006PTC049091', 20, 58, { textColor: [100, 100, 100] });
                        doc.text('Survey No. 118, National Highway No. 8-A', 105, 53);
                        doc.text('Tal. Morbi, Nava Jambudiya,', 105, 58);
                        doc.text('GJ 363642, INDIA', 105, 63);

                        doc.setFont('helvetica', 'bold');
                        doc.text('Contact:', 20, 71);
                        doc.text('Unit - 2:', 105, 71);
                        doc.setFont('helvetica', 'normal');
                        doc.text('ðŸ“§ Email: info@granicer.in', 20, 76);
                        doc.text('ðŸŒ Web: www.granicer.in', 20, 81);
                        doc.text('Revenue Survey No. 168 P1 and P2', 105, 76);
                        doc.text('Revenue Survey No. 169 P1 and P6', 105, 81);
                        doc.text('At Ratavirda, Wankaner, Morbi-Guj. -363621', 105, 86);
                        
                        // "PRICE LIST" à¤¬à¥‰à¤•à¥à¤¸
                        doc.setDrawColor(237, 50, 55); // Red
                        doc.setLineWidth(0.5);
                        doc.line(20, 90, 190, 90); // Top line
                        doc.line(20, 96, 190, 96); // Bottom line
                        doc.setFontSize(16);
                        doc.setFont('helvetica', 'bold');
                        doc.text('PRICE LIST', 105, 94.5, { align: 'center' });

                    } else {
                        // --- à¤ªà¥‡à¤œ 2+: à¤›à¥‹à¤Ÿà¤¾ à¤¹à¥‡à¤¡à¤° ---
                        doc.setDrawColor(237, 50, 55); // Red
                        doc.setLineWidth(0.5);
                        doc.line(20, 25, 190, 25); // Bottom line
                        doc.setFontSize(14);
                        doc.setFont('helvetica', 'bold');
                        doc.text('PRICE LIST (Continued)', 105, 22, { align: 'center' });
                        // à¤‡à¤¸ à¤ªà¥‡à¤œ à¤•à¥‡ à¤²à¤¿à¤ à¤Ÿà¥‡à¤¬à¤² à¤•à¥‹ à¤Šà¤ªà¤° à¤¸à¥‡ à¤¶à¥à¤°à¥‚ à¤•à¤°à¥‡à¤‚
                        data.settings.startY = 30; 
                    }
                }
            });

            // --- 3. à¤«à¥à¤Ÿà¤° (à¤¸à¤¿à¤°à¥à¤« à¤†à¤–à¤¿à¤°à¥€ à¤ªà¥‡à¤œ à¤ªà¤°) ---
            const pageCount = doc.internal.getNumberOfPages();
            doc.setPage(pageCount); // à¤†à¤–à¤¿à¤°à¥€ à¤ªà¥‡à¤œ à¤ªà¤° à¤œà¤¾à¤à¤‚
            
            let finalY = doc.autoTable.previous.finalY; // à¤Ÿà¥‡à¤¬à¤² à¤•à¤¹à¤¾à¤ à¤–à¤¤à¥à¤® à¤¹à¥à¤ˆ
            if (finalY > 230) {
                 doc.addPage();
                 //... à¤”à¤° à¤‡à¤¸ à¤¨à¤ à¤ªà¥‡à¤œ à¤ªà¤° à¤¹à¥‡à¤¡à¤° à¤”à¤° à¤²à¥‹à¤—à¥‹ à¤«à¤¿à¤° à¤¸à¥‡ à¤¬à¤¨à¤¾à¤à¤‚
                 // (à¤›à¥‹à¤Ÿà¤¾ à¤¹à¥‡à¤¡à¤°)
                 doc.setDrawColor(237, 50, 55); 
                 doc.setLineWidth(0.5);
                 doc.line(20, 25, 190, 25); 
                 doc.setFontSize(14);
                 doc.setFont('helvetica', 'bold');
                 doc.text('PRICE LIST (Continued)', 105, 22, { align: 'center' });
                 // (à¤²à¥‹à¤—à¥‹)
                 try {
                     doc.addImage(base64LogoA, 'PNG', 192, 0, 18, 21.5, '', 'NONE', 180);
                     doc.addImage(base64LogoA, 'PNG', 0, 275.2, 18, 21.5);
                 } catch (e) { console.error("Logo error on new page:", e.message); }
                 
                 finalY = 30; // à¤ªà¥‡à¤œ à¤•à¥‡ à¤Ÿà¥‰à¤ª à¤¸à¥‡ à¤«à¥à¤Ÿà¤° à¤¶à¥à¤°à¥‚ à¤•à¤°à¥‡à¤‚
            }

            // à¤«à¥à¤Ÿà¤° à¤¡à¥à¤°à¥‰ à¤•à¤°à¥‡à¤‚
            drawFooter(finalY + 10); // 10mm à¤®à¤¾à¤°à¥à¤œà¤¿à¤¨ à¤•à¥‡ à¤¸à¤¾à¤¥
            
            function drawFooter(startY) {
                doc.setDrawColor(237, 50, 55); // Red
                doc.setLineWidth(1);
                doc.line(20, startY, 190, startY); // à¤Ÿà¥‰à¤ª à¤°à¥‡à¤¡ à¤²à¤¾à¤‡à¤¨
                
                startY += 5;
                doc.setFontSize(10);
                doc.setFont('helvetica', 'bold');
                doc.text('Terms & Conditions:', 20, startY);
                
                startY += 4;
                doc.setFontSize(8);
                doc.setFont('helvetica', 'normal');
                const terms = [
                    'All prices are ex-factory and exclusive of GST unless stated otherwise.',
                    'Prices are subject to change without prior notice depending on market conditions.',
                    'Delivery period will be confirmed after order placement.',
                    'The company is not responsible for delays due to transport or unforeseen events.',
                    'The company is not liable once goods leave the factory.',
                    'GST and any other government levies will be charged extra as applicable at the time of billing.',
                    'No return or replacement will be accepted once goods are sold, except for genuine manufacturing defects verified by the company.',
                    'Placing an order implies acceptance of the above terms & conditions.'
                ];
                doc.text(terms, 23, startY, { lineHeightFactor: 1.5, maxWidth: 167 });
                
                startY += (terms.length * 8 * 0.5) + 8; // à¤œà¤—à¤¹ à¤•à¤¾ à¤…à¤¨à¥à¤®à¤¾à¤¨ à¤²à¤—à¤¾à¤à¤‚
                
                doc.setDrawColor(200, 200, 200); // Grey
                doc.setLineWidth(0.25);
                doc.line(20, startY, 190, startY); // à¤—à¥à¤°à¥‡ à¤¸à¥‡à¤ªà¤°à¥‡à¤Ÿà¤°
                
                startY += 4;
                doc.setFontSize(7);
                doc.setTextColor(150, 150, 150); // Grey text
                doc.text('This is an electronically generated price list. For further information, please contact our sales team.', 105, startY, { align: 'center' });
                startY += 3;
                doc.text(`Generated on: ${currentDate}`, 105, startY, { align: 'center' });
                startY += 3;
                doc.text("GRANICER CERAMICA INDIA - Asia's Largest Porcelain Slabs & Tiles Manufacturer", 105, startY, { align: 'center' });
            }

            // --- PDF à¤•à¥‹ à¤¸à¥‡à¤µ à¤•à¤°à¥‡à¤‚ ---
            doc.save('Granicer_PriceList_' + new Date().toISOString().slice(0, 10) + '.pdf');
        }


        function clearForm() {
            document.getElementById('size').value = '';
            document.getElementById('surface').value = '';
            document.getElementById('price').value = '';
            document.getElementById('size').focus();
        }

        function switchTab(tabName) {
            const tabs = document.querySelectorAll('.tab-content');
            const buttons = document.querySelectorAll('.tab-btn');

            tabs.forEach((tab) => tab.classList.remove('active'));
            buttons.forEach((btn) => btn.classList.remove('active'));

            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        // à¤¬à¤¾à¤¹à¤° à¤•à¥à¤²à¤¿à¤• à¤•à¤°à¤¨à¥‡ à¤ªà¤° à¤¸à¤œà¥‡à¤¶à¤¨ à¤›à¤¿à¤ªà¤¾à¤à¤‚
        document.addEventListener('click', function (event) {
            if (!event.target.closest('.input-wrapper')) {
                document.getElementById('sizeSuggestions').classList.remove('show');
                document.getElementById('surfaceSuggestions').classList.remove('show');
                activeSuggestionIndex = -1; 
            }
        });

        // Initialize
        renderItems();

        // à¤•à¥€à¤¬à¥‹à¤°à¥à¤¡ à¤¨à¥‡à¤µà¤¿à¤—à¥‡à¤¶à¤¨ à¤•à¥‡ à¤²à¤¿à¤ à¤«à¤¼à¤‚à¤•à¥à¤¶à¤¨
        function handleSuggestionKeydown(e, type) {
            const suggestionsId = type ==='size' ? 'sizeSuggestions' : 'surfaceSuggestions';
            const suggestionsDiv = document.getElementById(suggestionsId);
            
            if (!suggestionsDiv.classList.contains('show')) {
                activeSuggestionIndex = -1;
                return;
            }

            const items = suggestionsDiv.querySelectorAll('.suggestion-item');
            if (items.length === 0) {
                activeSuggestionIndex = -1;
                return;
            }

            items.forEach(item => item.classList.remove('suggestion-active'));

            if (e.key === 'ArrowDown') {
                e.preventDefault(); 
                activeSuggestionIndex++;
                if (activeSuggestionIndex >= items.length) {
                    activeSuggestionIndex = 0; 
                }
            } else if (e.key === 'ArrowUp') {
                e.preventDefault(); 
                activeSuggestionIndex--;
                if (activeSuggestionIndex < 0) {
                    activeSuggestionIndex = items.length - 1; 
                }
            } else if (e.key === 'Enter') {
                e.preventDefault(); 
                if (activeSuggestionIndex > -1 && items[activeSuggestionIndex]) {
                    items[activeSuggestionIndex].click(); 
                    activeSuggestionIndex = -1; 
                }
            } else if (e.key === 'Escape') {
                suggestionsDiv.classList.remove('show'); 
                activeSuggestionIndex = -1;
            }

            if (activeSuggestionIndex > -1 && items[activeSuggestionIndex]) {
                items[activeSuggestionIndex].classList.add('suggestion-active');
                items[activeSuggestionIndex].scrollIntoView({
                    behavior: 'smooth',
                    block: 'nearest'
                });
            }
        }

        document.getElementById('size').addEventListener('keydown', (e) => handleSuggestionKeydown(e, 'size'));
        document.getElementById('surface').addEventListener('keydown', (e) => handleSuggestionKeydown(e, 'surface'));
    </script>
